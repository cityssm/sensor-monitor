"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=exports.urlPrefix,t={},s=(e,s)=>{let o=!1;if(s||(s=document.querySelector(`[data-config-key='${e.configKey}']`).querySelector(`[data-sensor-key='${e.sensorKey}']`),o=!0),!s)return;const a=s.querySelector(".sensor-status");(e=>{e.classList.remove("has-text-danger","has-text-warning","has-text-success","has-text-grey")})(a),e.isError?a.classList.add("has-text-warning"):e.sensorText?a.classList.add("has-text-danger"):a.classList.add("has-text-success");for(const t of s.querySelectorAll("[data-field='sensorValue']"))t.textContent=e.sensorValue.toString();for(const t of s.querySelectorAll("[data-field='statusTime']"))t.textContent=new Date(e.statusTimeMillis).toLocaleString();for(const t of s.querySelectorAll("[data-field='sensorValueMin']"))t.textContent=e.sensorValueMin.toString();for(const t of s.querySelectorAll("[data-field='sensorValueMax']"))t.textContent=e.sensorValueMax.toString();for(const t of s.querySelectorAll("[data-field='sensorText']"))t.textContent=e.sensorText;if(o){const o=s.querySelector(".chart"),a=t[e.configKey][e.sensorKey],r=a.getOption().series[0].data;for(;r.length>1e4;)r.shift();const n={value:[new Date(e.statusTimeMillis),e.sensorValue]};o.dataset.min&&Number.parseFloat(o.dataset.min)>e.sensorValue||o.dataset.max&&Number.parseFloat(o.dataset.max)<e.sensorValue?(n.symbol="circle",n.symbolSize=4,n.itemStyle={color:"red"}):n.symbolSize=0,r.push(n),a.setOption({series:{data:r}})}},o=exports.historicalStatusLogs,a=(e,s,a)=>{const r=o[e][s],n=a.querySelector(".chart"),l=echarts.init(n),i={tooltip:{trigger:"axis"},xAxis:{type:"time"},yAxis:[{type:"value",min:"dataMin",max:"dataMax"}],series:[{data:[],type:"line",smooth:!0}]};for(const e of r){const t={value:[new Date(e.statusTimeMillis),e.sensorValue]};n.dataset.min&&Number.parseFloat(n.dataset.min)>e.sensorValue||n.dataset.max&&Number.parseFloat(n.dataset.max)<e.sensorValue?(t.symbol="circle",t.symbolSize=4,t.itemStyle={color:"red"}):t.symbolSize=0,i.series[0].data.push(t)}l.setOption(i),t[e][s]=l};(()=>{for(const[e,s]of Object.entries(o)){const o=document.querySelector(`[data-config-key='${e}']`);if(o){t[e]={};for(const[t,r]of Object.entries(s)){const s=o.querySelector(`[data-sensor-key='${t}']`);s&&0!==r.length&&a(e,t,s)}}}const e=exports.currentStatusLogs;for(const t of e)s(t)})();const r=Number.parseInt(document.querySelector("main").dataset.pollingMillis,10);window.setInterval(()=>{cityssm.postJSON(e+"/doGetCurrentStatusLogs",{},e=>{for(const t of e.currentStatusLogs)s(t)})},r)})();